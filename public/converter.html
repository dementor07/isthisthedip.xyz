<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Converter - Bitcoin to USD, ETH to BTC | Live Exchange Rates</title>
    <meta name="description" content="Free cryptocurrency converter with live exchange rates. Convert Bitcoin to USD, Ethereum to BTC, and 500+ crypto pairs. Real-time crypto currency calculator.">
    <meta property="og:title" content="Crypto Converter - Live Cryptocurrency Exchange Rates">
    <meta property="og:description" content="Convert between Bitcoin, Ethereum, and 500+ cryptocurrencies with real-time exchange rates. Free crypto currency converter and calculator.">
    <meta property="og:url" content="https://isthisthedip.xyz/converter">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="IsThisTheDip.xyz">
    <link rel="canonical" href="https://isthisthedip.xyz/converter">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Cryptocurrency Converter",
        "description": "Free cryptocurrency converter with live exchange rates for Bitcoin, Ethereum, and 500+ digital currencies. Real-time crypto to fiat and crypto to crypto conversion.",
        "url": "https://isthisthedip.xyz/converter",
        "applicationCategory": "FinanceApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD",
            "name": "Free Crypto Converter"
        },
        "featureList": [
            "Real-time cryptocurrency conversion",
            "500+ supported cryptocurrencies",
            "Crypto to fiat conversion",
            "Crypto to crypto exchange rates",
            "Historical price charts"
        ]
    }
    </script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
        }
        .converter-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .rate-card {
            transition: transform 0.3s ease;
        }
        .rate-card:hover {
            transform: translateY(-2px);
        }
        .flip-animation {
            animation: flip 0.6s ease-in-out;
        }
        @keyframes flip {
            0% { transform: rotateY(0deg); }
            50% { transform: rotateY(90deg); }
            100% { transform: rotateY(0deg); }
        }
    </style>
</head>

<body class="bg-gray-900 text-white min-h-screen">
    <!-- Header -->
    <header class="gradient-bg shadow-lg">
        <div class="container mx-auto px-4 py-4">
            <div class="hidden md:flex justify-between items-center">
                <div class="flex items-center space-x-6">
                    <a href="/" class="text-2xl font-bold flex items-center hover:opacity-80 transition-opacity">
                        <span class="mr-2">🔄</span> Crypto Converter
                    </a>
                    <nav class="flex items-center space-x-4">
                        <a href="/" class="text-sm hover:text-blue-200 transition-colors">Home</a>
                        <a href="/profit-calculator" class="text-sm hover:text-blue-200 transition-colors">💰 Profit Calculator</a>
                        <a href="/converter" class="text-sm text-blue-200">🔄 Converter</a>
                        <a href="/bitcoin" class="text-sm hover:text-blue-200 transition-colors">₿ Bitcoin</a>
                        <a href="/ethereum" class="text-sm hover:text-blue-200 transition-colors">Ξ Ethereum</a>
                    </nav>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Hero Section -->
        <div class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold mb-4">
                <span class="text-5xl mr-3">🔄</span>
                Cryptocurrency Converter
            </h1>
            <p class="text-xl text-gray-400 mb-6 max-w-3xl mx-auto">
                Convert between Bitcoin, Ethereum, and 500+ cryptocurrencies with real-time exchange rates. Free crypto to fiat and crypto to crypto conversion.
            </p>
            <div class="flex flex-wrap justify-center gap-4 text-sm">
                <span class="bg-blue-600 text-white px-3 py-1 rounded-full">✓ Live Exchange Rates</span>
                <span class="bg-green-600 text-white px-3 py-1 rounded-full">✓ 500+ Currencies</span>
                <span class="bg-purple-600 text-white px-3 py-1 rounded-full">✓ Crypto ↔ Fiat</span>
                <span class="bg-yellow-600 text-black px-3 py-1 rounded-full">✓ Instant Conversion</span>
            </div>
        </div>

        <!-- Converter Tool -->
        <div class="max-w-4xl mx-auto mb-12">
            <div class="converter-card rounded-2xl p-8">
                <div class="grid md:grid-cols-3 gap-8 items-center">
                    
                    <!-- From Currency -->
                    <div class="space-y-4">
                        <h3 class="text-lg font-semibold text-center">From</h3>
                        
                        <!-- Currency Selection -->
                        <div class="relative">
                            <input type="text" id="fromCurrency" placeholder="Search cryptocurrency or fiat currency..." 
                                   class="w-full px-4 py-3 bg-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none text-center"
                                   autocomplete="off" readonly>
                            <div id="fromCurrencyDropdown" class="absolute top-full left-0 right-0 bg-gray-800 rounded-lg shadow-lg border border-gray-700 z-50 max-h-60 overflow-y-auto hidden">
                                <!-- Search results will be populated here -->
                            </div>
                            <div class="text-xs text-gray-400 mt-2 text-center">
                                <span id="fromCurrencyCount">Loading currencies...</span>
                            </div>
                        </div>

                        <!-- Amount Input -->
                        <div>
                            <input type="number" id="fromAmount" placeholder="1" value="1" step="0.00000001"
                                   class="w-full px-4 py-4 bg-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none text-center text-2xl font-bold">
                        </div>

                        <!-- Current Price Display -->
                        <div class="text-center text-sm text-gray-400">
                            <span id="fromPrice">$95,847 per BTC</span>
                        </div>
                    </div>

                    <!-- Swap Button -->
                    <div class="text-center">
                        <button onclick="swapCurrencies()" class="bg-blue-600 hover:bg-blue-700 text-white w-16 h-16 rounded-full text-2xl transition-all duration-300 hover:scale-110" id="swapButton">
                            <i class="fas fa-exchange-alt"></i>
                        </button>
                        <p class="text-sm text-gray-400 mt-2">Click to swap</p>
                    </div>

                    <!-- To Currency -->
                    <div class="space-y-4">
                        <h3 class="text-lg font-semibold text-center">To</h3>
                        
                        <!-- Currency Selection -->
                        <div class="relative">
                            <input type="text" id="toCurrency" placeholder="Search cryptocurrency or fiat currency..." 
                                   class="w-full px-4 py-3 bg-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none text-center"
                                   autocomplete="off" readonly>
                            <div id="toCurrencyDropdown" class="absolute top-full left-0 right-0 bg-gray-800 rounded-lg shadow-lg border border-gray-700 z-50 max-h-60 overflow-y-auto hidden">
                                <!-- Search results will be populated here -->
                            </div>
                            <div class="text-xs text-gray-400 mt-2 text-center">
                                <span id="toCurrencyCount">Loading currencies...</span>
                            </div>
                        </div>

                        <!-- Converted Amount -->
                        <div>
                            <input type="text" id="toAmount" readonly 
                                   class="w-full px-4 py-4 bg-gray-800 rounded-lg text-center text-2xl font-bold text-green-400 border-2 border-green-600">
                        </div>

                        <!-- Exchange Rate -->
                        <div class="text-center text-sm text-gray-400">
                            <span id="exchangeRate">1 BTC = $95,847 USD</span>
                        </div>
                    </div>

                </div>

                <!-- Conversion History -->
                <div class="mt-8 pt-6 border-t border-gray-700">
                    <div class="flex justify-between items-center mb-4">
                        <h4 class="text-lg font-semibold">Recent Conversions</h4>
                        <button onclick="clearHistory()" class="text-red-400 hover:text-red-300 text-sm">
                            <i class="fas fa-trash mr-1"></i>Clear
                        </button>
                    </div>
                    <div id="conversionHistory" class="space-y-2 max-h-32 overflow-y-auto">
                        <p class="text-gray-400 text-center py-4">No conversions yet</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Popular Conversions -->
        <div class="max-w-4xl mx-auto mb-12">
            <h2 class="text-3xl font-bold mb-8 text-center">Popular Crypto Conversions</h2>
            <div class="grid md:grid-cols-3 gap-6">
                
                <!-- Bitcoin to USD -->
                <div class="rate-card bg-gray-800 rounded-lg p-6 cursor-pointer" onclick="loadConversion('bitcoin', 'usd', 1)">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center">
                            <span class="text-2xl mr-2">₿</span>
                            <span class="font-bold">BTC → USD</span>
                        </div>
                        <span class="text-green-400 font-bold">$95,847</span>
                    </div>
                    <p class="text-gray-400 text-sm">1 Bitcoin = $95,847 USD</p>
                    <p class="text-xs text-gray-500 mt-2">Click to convert</p>
                </div>

                <!-- Ethereum to USD -->
                <div class="rate-card bg-gray-800 rounded-lg p-6 cursor-pointer" onclick="loadConversion('ethereum', 'usd', 1)">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center">
                            <span class="text-2xl mr-2">Ξ</span>
                            <span class="font-bold">ETH → USD</span>
                        </div>
                        <span class="text-green-400 font-bold">$3,247</span>
                    </div>
                    <p class="text-gray-400 text-sm">1 Ethereum = $3,247 USD</p>
                    <p class="text-xs text-gray-500 mt-2">Click to convert</p>
                </div>

                <!-- Bitcoin to Ethereum -->
                <div class="rate-card bg-gray-800 rounded-lg p-6 cursor-pointer" onclick="loadConversion('bitcoin', 'ethereum', 1)">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center">
                            <span class="text-2xl mr-2">₿→Ξ</span>
                            <span class="font-bold">BTC → ETH</span>
                        </div>
                        <span class="text-green-400 font-bold">29.52</span>
                    </div>
                    <p class="text-gray-400 text-sm">1 Bitcoin = 29.52 Ethereum</p>
                    <p class="text-xs text-gray-500 mt-2">Click to convert</p>
                </div>

            </div>
        </div>

        <!-- Quick Conversion Buttons -->
        <div class="max-w-4xl mx-auto mb-12">
            <h2 class="text-3xl font-bold mb-8 text-center">Quick Conversions</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                
                <button onclick="loadConversion('bitcoin', 'usd', 0.01)" class="bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 px-4 rounded-lg transition">
                    0.01 BTC → USD
                </button>
                
                <button onclick="loadConversion('ethereum', 'usd', 1)" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition">
                    1 ETH → USD
                </button>
                
                <button onclick="loadConversion('usd', 'bitcoin', 1000)" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg transition">
                    $1,000 → BTC
                </button>
                
                <button onclick="loadConversion('usd', 'ethereum', 5000)" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-4 rounded-lg transition">
                    $5,000 → ETH
                </button>

            </div>
        </div>

        <!-- Market Overview -->
        <div class="max-w-4xl mx-auto mb-12">
            <h2 class="text-3xl font-bold mb-8 text-center">Live Cryptocurrency Prices</h2>
            <div class="overflow-x-auto">
                <table class="w-full bg-gray-800 rounded-lg">
                    <thead>
                        <tr class="border-b border-gray-700">
                            <th class="text-left p-4">Cryptocurrency</th>
                            <th class="text-center p-4">Price (USD)</th>
                            <th class="text-center p-4">24h Change</th>
                            <th class="text-center p-4">Market Cap</th>
                            <th class="text-center p-4">Convert</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="border-b border-gray-700">
                            <td class="p-4">
                                <div class="flex items-center">
                                    <span class="text-2xl mr-3">₿</span>
                                    <div>
                                        <div class="font-bold">Bitcoin</div>
                                        <div class="text-sm text-gray-400">BTC</div>
                                    </div>
                                </div>
                            </td>
                            <td class="text-center p-4 font-bold">$95,847</td>
                            <td class="text-center p-4 text-red-400">-2.3%</td>
                            <td class="text-center p-4">$1.89T</td>
                            <td class="text-center p-4">
                                <button onclick="loadConversion('bitcoin', 'usd', 1)" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm">
                                    Convert
                                </button>
                            </td>
                        </tr>
                        <tr class="border-b border-gray-700">
                            <td class="p-4">
                                <div class="flex items-center">
                                    <span class="text-2xl mr-3">Ξ</span>
                                    <div>
                                        <div class="font-bold">Ethereum</div>
                                        <div class="text-sm text-gray-400">ETH</div>
                                    </div>
                                </div>
                            </td>
                            <td class="text-center p-4 font-bold">$3,247</td>
                            <td class="text-center p-4 text-red-400">-3.1%</td>
                            <td class="text-center p-4">$391B</td>
                            <td class="text-center p-4">
                                <button onclick="loadConversion('ethereum', 'usd', 1)" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm">
                                    Convert
                                </button>
                            </td>
                        </tr>
                        <tr class="border-b border-gray-700">
                            <td class="p-4">
                                <div class="flex items-center">
                                    <span class="text-2xl mr-3">◎</span>
                                    <div>
                                        <div class="font-bold">Solana</div>
                                        <div class="text-sm text-gray-400">SOL</div>
                                    </div>
                                </div>
                            </td>
                            <td class="text-center p-4 font-bold">$189</td>
                            <td class="text-center p-4 text-green-400">+1.8%</td>
                            <td class="text-center p-4">$89B</td>
                            <td class="text-center p-4">
                                <button onclick="loadConversion('solana', 'usd', 1)" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm">
                                    Convert
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Call to Action -->
        <div class="max-w-4xl mx-auto text-center bg-gradient-to-r from-blue-900 to-purple-900 rounded-2xl p-8">
            <h2 class="text-3xl font-bold mb-4">Need Advanced Conversion Tools?</h2>
            <p class="text-gray-300 mb-6 max-w-2xl mx-auto">
                Get access to advanced features like portfolio conversion tracking, historical exchange rate charts, and custom watchlists for your favorite crypto pairs.
            </p>
            <div class="flex flex-col md:flex-row gap-4 justify-center">
                <a href="/pricing" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg transition">
                    Upgrade to Premium
                </a>
                <a href="/profit-calculator" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-lg transition">
                    Try Profit Calculator
                </a>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="mt-20 py-8 border-t border-gray-800">
        <div class="container mx-auto px-4 text-center text-gray-500">
            <div class="flex flex-wrap justify-center gap-4 md:gap-6 mb-4">
                <a href="/" class="hover:text-white text-sm">Home</a>
                <a href="/profit-calculator" class="hover:text-white text-sm">💰 Profit Calculator</a>
                <a href="/converter" class="hover:text-white text-sm text-blue-400">🔄 Converter</a>
                <a href="/bitcoin" class="hover:text-white text-sm">₿ Bitcoin</a>
                <a href="/ethereum" class="hover:text-white text-sm">Ξ Ethereum</a>
            </div>
            <p class="text-xs md:text-sm px-4">© 2025 IsThisTheDip.xyz | Free cryptocurrency converter with live exchange rates</p>
        </div>
    </footer>

    <script>
        // Currency data with real-time prices - will be populated dynamically
        let currencyData = {};
        let availableCryptos = [];
        let availableFiats = [];

        // Load comprehensive currency lists
        async function loadCurrencyLists() {
            try {
                // Load top 500 cryptocurrencies
                const cryptoResponse = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=250&page=1');
                const cryptoPage1 = await cryptoResponse.json();
                
                const cryptoResponse2 = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=250&page=2');
                const cryptoPage2 = await cryptoResponse2.json();
                
                const allCryptos = [...cryptoPage1, ...cryptoPage2];
                
                // Process cryptocurrencies
                availableCryptos = allCryptos.map(coin => ({
                    id: coin.id,
                    symbol: coin.symbol.toUpperCase(),
                    name: coin.name,
                    price: coin.current_price || 0,
                    type: 'crypto'
                }));

                // Load supported fiat currencies
                const fiatResponse = await fetch('https://api.coingecko.com/api/v3/simple/supported_vs_currencies');
                const fiatList = await fiatResponse.json();
                
                // Major fiat currencies with proper names
                const fiatNames = {
                    'usd': 'US Dollar', 'eur': 'Euro', 'gbp': 'British Pound', 'jpy': 'Japanese Yen',
                    'cad': 'Canadian Dollar', 'aud': 'Australian Dollar', 'chf': 'Swiss Franc', 'cny': 'Chinese Yuan',
                    'inr': 'Indian Rupee', 'krw': 'South Korean Won', 'brl': 'Brazilian Real', 'rub': 'Russian Ruble',
                    'mxn': 'Mexican Peso', 'sgd': 'Singapore Dollar', 'hkd': 'Hong Kong Dollar', 'nok': 'Norwegian Krone',
                    'sek': 'Swedish Krona', 'dkk': 'Danish Krone', 'pln': 'Polish Złoty', 'czk': 'Czech Koruna',
                    'huf': 'Hungarian Forint', 'ils': 'Israeli Shekel', 'nzd': 'New Zealand Dollar', 'zar': 'South African Rand',
                    'thb': 'Thai Baht', 'try': 'Turkish Lira', 'aed': 'UAE Dirham', 'sar': 'Saudi Riyal',
                    'pkr': 'Pakistani Rupee', 'bdt': 'Bangladeshi Taka', 'vnd': 'Vietnamese Dong', 'idr': 'Indonesian Rupiah',
                    'myr': 'Malaysian Ringgit', 'php': 'Philippine Peso', 'twd': 'Taiwan Dollar', 'clp': 'Chilean Peso',
                    'cop': 'Colombian Peso', 'pen': 'Peruvian Sol', 'ars': 'Argentine Peso', 'uyu': 'Uruguayan Peso',
                    'gel': 'Georgian Lari', 'kzt': 'Kazakhstani Tenge', 'uzs': 'Uzbekistani Som', 'azn': 'Azerbaijani Manat',
                    'amd': 'Armenian Dram', 'byn': 'Belarusian Ruble', 'mdl': 'Moldovan Leu', 'bgn': 'Bulgarian Lev',
                    'ron': 'Romanian Leu', 'hrk': 'Croatian Kuna', 'rsd': 'Serbian Dinar', 'mkd': 'Macedonian Denar',
                    'all': 'Albanian Lek', 'bam': 'Bosnia-Herzegovina Mark', 'isk': 'Icelandic Króna'
                };

                // Process fiat currencies (use first 50 major ones)
                availableFiats = fiatList.slice(0, 50).map(code => ({
                    id: code,
                    symbol: code.toUpperCase(),
                    name: fiatNames[code] || `${code.toUpperCase()} Currency`,
                    price: 1, // Will be updated with real rates
                    type: 'fiat'
                }));

                // Initialize currency data
                [...availableCryptos, ...availableFiats].forEach(currency => {
                    currencyData[currency.id] = currency;
                });

                console.log(`✅ Loaded ${availableCryptos.length} cryptocurrencies and ${availableFiats.length} fiat currencies`);
                initializeCurrencySearch();
                
            } catch (error) {
                console.error('Failed to load currency lists:', error);
                // Fallback to basic currencies
                loadBasicCurrencies();
            }
        }

        // Fallback basic currencies if API fails
        function loadBasicCurrencies() {
            availableCryptos = [
                { id: 'bitcoin', symbol: 'BTC', name: 'Bitcoin', price: 95847, type: 'crypto' },
                { id: 'ethereum', symbol: 'ETH', name: 'Ethereum', price: 3247, type: 'crypto' },
                { id: 'solana', symbol: 'SOL', name: 'Solana', price: 189, type: 'crypto' },
                { id: 'cardano', symbol: 'ADA', name: 'Cardano', price: 0.87, type: 'crypto' },
                { id: 'dogecoin', symbol: 'DOGE', name: 'Dogecoin', price: 0.32, type: 'crypto' }
            ];
            
            availableFiats = [
                { id: 'usd', symbol: 'USD', name: 'US Dollar', price: 1, type: 'fiat' },
                { id: 'eur', symbol: 'EUR', name: 'Euro', price: 0.92, type: 'fiat' },
                { id: 'gbp', symbol: 'GBP', name: 'British Pound', price: 0.79, type: 'fiat' },
                { id: 'jpy', symbol: 'JPY', name: 'Japanese Yen', price: 150, type: 'fiat' }
            ];

            [...availableCryptos, ...availableFiats].forEach(currency => {
                currencyData[currency.id] = currency;
            });
            
            initializeCurrencySearch();
        }

        // Currency search and selection state
        let selectedFromCurrency = null;
        let selectedToCurrency = null;
        let searchTimeout = null;
        
        // Initialize currency search interface
        function initializeCurrencySearch() {
            const fromInput = document.getElementById('fromCurrency');
            const toInput = document.getElementById('toCurrency');
            
            // Set initial values
            selectedFromCurrency = currencyData.bitcoin || availableCryptos[0];
            selectedToCurrency = currencyData.usd || availableFiats[0];
            
            updateCurrencyDisplay('from');
            updateCurrencyDisplay('to');
            
            // Set up search functionality
            setupCurrencySearch('from');
            setupCurrencySearch('to');
            
            // Update counter
            document.getElementById('fromCurrencyCount').textContent = 
                `${availableCryptos.length} cryptocurrencies, ${availableFiats.length} fiat currencies`;
            document.getElementById('toCurrencyCount').textContent = 
                `${availableCryptos.length} cryptocurrencies, ${availableFiats.length} fiat currencies`;
        }
        
        // Setup search functionality for currency input
        function setupCurrencySearch(type) {
            const input = document.getElementById(`${type}Currency`);
            const dropdown = document.getElementById(`${type}CurrencyDropdown`);
            
            // Make input editable when clicked
            input.addEventListener('click', () => {
                input.removeAttribute('readonly');
                input.placeholder = 'Type to search currencies...';
                showTopCurrencies(type);
                input.focus();
            });
            
            // Handle input changes
            input.addEventListener('input', (e) => {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    searchCurrencies(e.target.value, type);
                }, 150);
            });
            
            // Handle clicking outside
            document.addEventListener('click', (e) => {
                if (!input.contains(e.target) && !dropdown.contains(e.target)) {
                    hideDropdown(type);
                    updateCurrencyDisplay(type);
                }
            });
            
            // Handle escape key
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    hideDropdown(type);
                    updateCurrencyDisplay(type);
                }
            });
        }
        
        // Show top recommended currencies
        function showTopCurrencies(type) {
            const dropdown = document.getElementById(`${type}CurrencyDropdown`);
            
            // Top recommended currencies
            const topCryptos = availableCryptos.slice(0, 8);
            const topFiats = [
                currencyData.usd, currencyData.eur, currencyData.gbp, 
                currencyData.jpy, currencyData.cad, currencyData.aud,
                currencyData.chf, currencyData.cny
            ].filter(Boolean);
            
            let html = '';
            
            if (topCryptos.length > 0) {
                html += '<div class="p-2 text-xs font-semibold text-gray-400 border-b border-gray-700">Popular Cryptocurrencies</div>';
                topCryptos.forEach(currency => {
                    html += createCurrencyOption(currency, type);
                });
            }
            
            if (topFiats.length > 0) {
                html += '<div class="p-2 text-xs font-semibold text-gray-400 border-b border-gray-700">Major Fiat Currencies</div>';
                topFiats.forEach(currency => {
                    html += createCurrencyOption(currency, type);
                });
            }
            
            dropdown.innerHTML = html;
            dropdown.classList.remove('hidden');
        }
        
        // Search currencies by name or symbol
        function searchCurrencies(query, type) {
            const dropdown = document.getElementById(`${type}CurrencyDropdown`);
            
            if (!query.trim()) {
                showTopCurrencies(type);
                return;
            }
            
            const searchTerm = query.toLowerCase();
            const allCurrencies = [...availableCryptos, ...availableFiats];
            
            // Fuzzy search
            const matches = allCurrencies.filter(currency => 
                currency.name.toLowerCase().includes(searchTerm) ||
                currency.symbol.toLowerCase().includes(searchTerm) ||
                currency.id.toLowerCase().includes(searchTerm)
            ).slice(0, 20); // Limit to 20 results
            
            let html = '';
            
            if (matches.length > 0) {
                html += `<div class="p-2 text-xs font-semibold text-gray-400 border-b border-gray-700">Search Results (${matches.length})</div>`;
                matches.forEach(currency => {
                    html += createCurrencyOption(currency, type);
                });
            } else {
                html = '<div class="p-4 text-center text-gray-400">No currencies found</div>';
            }
            
            dropdown.innerHTML = html;
            dropdown.classList.remove('hidden');
        }
        
        // Create currency option HTML
        function createCurrencyOption(currency, type) {
            const priceDisplay = currency.type === 'crypto' 
                ? `$${currency.price?.toLocaleString() || '0'}` 
                : currency.symbol;
                
            return `
                <div class="p-3 hover:bg-gray-700 cursor-pointer flex items-center justify-between" onclick="selectCurrency('${currency.id}', '${type}')">
                    <div class="flex items-center">
                        <div class="text-xs px-2 py-1 rounded ${currency.type === 'crypto' ? 'bg-blue-600' : 'bg-green-600'} text-white mr-3">
                            ${currency.type === 'crypto' ? 'CRYPTO' : 'FIAT'}
                        </div>
                        <div>
                            <div class="font-semibold">${currency.name}</div>
                            <div class="text-sm text-gray-400">${currency.symbol}</div>
                        </div>
                    </div>
                    <div class="text-sm font-mono">${priceDisplay}</div>
                </div>
            `;
        }
        
        // Select a currency
        function selectCurrency(currencyId, type) {
            const currency = currencyData[currencyId];
            if (!currency) return;
            
            if (type === 'from') {
                selectedFromCurrency = currency;
            } else {
                selectedToCurrency = currency;
            }
            
            hideDropdown(type);
            updateCurrencyDisplay(type);
            updatePriceDisplay();
            convert();
        }
        
        // Hide dropdown
        function hideDropdown(type) {
            const dropdown = document.getElementById(`${type}CurrencyDropdown`);
            const input = document.getElementById(`${type}Currency`);
            
            dropdown.classList.add('hidden');
            input.setAttribute('readonly', 'true');
            input.placeholder = 'Search cryptocurrency or fiat currency...';
        }
        
        // Update currency display
        function updateCurrencyDisplay(type) {
            const input = document.getElementById(`${type}Currency`);
            const currency = type === 'from' ? selectedFromCurrency : selectedToCurrency;
            
            if (currency) {
                input.value = `${currency.name} (${currency.symbol})`;
            }
        }

        // Fetch real-time crypto prices and fiat rates
        async function fetchRealTimeRates() {
            try {
                if (availableCryptos.length === 0) return; // Wait for currencies to load
                
                // Fetch crypto prices and fiat exchange rates in parallel
                const [cryptoRates, fiatRates] = await Promise.all([
                    fetchCryptoRates(),
                    fetchFiatExchangeRates()
                ]);
                
                console.log(`✅ Real-time rates updated for ${availableCryptos.length} cryptos and ${availableFiats.length} fiat currencies`);
                updateMarketOverview();
                updatePriceDisplay();
                convert();
            } catch (error) {
                console.warn('⚠️ Failed to fetch real-time rates, using cached data:', error);
            }
        }

        // Fetch cryptocurrency rates from CoinGecko
        async function fetchCryptoRates() {
            try {
                // Get crypto prices (first 100 for API limits)
                const cryptosToUpdate = availableCryptos.slice(0, 100).map(c => c.id).join(',');
                const fiatCurrencies = 'usd,eur,gbp,jpy,cad,aud,chf,cny,inr,krw'; // Major currencies for crypto pricing
                
                const cryptoResponse = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${cryptosToUpdate}&vs_currencies=${fiatCurrencies}&include_24hr_change=true`);
                const cryptoData = await cryptoResponse.json();
                
                // Update crypto prices
                availableCryptos.forEach(crypto => {
                    if (cryptoData[crypto.id]) {
                        currencyData[crypto.id].price = cryptoData[crypto.id].usd || 0;
                        currencyData[crypto.id].change_24h = cryptoData[crypto.id].usd_24h_change || 0;
                        // Store all currency prices for accurate conversions
                        currencyData[crypto.id].prices = cryptoData[crypto.id];
                    }
                });
                
                return cryptoData;
            } catch (error) {
                console.error('Failed to fetch crypto rates:', error);
                return {};
            }
        }

        // Fetch fiat exchange rates with multiple fallback sources (no API keys required)
        async function fetchFiatExchangeRates() {
            // Try multiple free exchange rate APIs in order
            const sources = [
                {
                    name: 'exchangerate-api.com (free)',
                    url: 'https://api.exchangerate-api.com/v4/latest/USD',
                    parser: (data) => data.rates
                },
                {
                    name: 'fxratesapi.com (free)',
                    url: 'https://api.fxratesapi.com/latest?base=USD',
                    parser: (data) => data.rates
                }
            ];

            for (const source of sources) {
                try {
                    console.log(`Trying ${source.name}...`);
                    const response = await fetch(source.url);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}`);
                    }
                    
                    const exchangeData = await response.json();
                    const rates = source.parser(exchangeData);
                    
                    if (rates && Object.keys(rates).length > 10) {
                        // Update fiat currency rates
                        let updatedCount = 0;
                        availableFiats.forEach(fiat => {
                            if (fiat.id === 'usd') {
                                currencyData[fiat.id].price = 1; // USD base
                                updatedCount++;
                            } else {
                                const rate = rates[fiat.id.toUpperCase()];
                                if (rate) {
                                    // Rate represents how many units of fiat currency = 1 USD
                                    currencyData[fiat.id].price = rate;
                                    updatedCount++;
                                }
                            }
                        });
                        
                        console.log(`✅ Updated ${updatedCount} fiat exchange rates from ${source.name}`);
                        
                        // Fill in any missing rates with manual fallback
                        await fillMissingFiatRates();
                        
                        return exchangeData;
                    }
                } catch (error) {
                    console.warn(`Failed to fetch from ${source.name}:`, error.message);
                    continue; // Try next source
                }
            }
            
            // If all external APIs fail, use CoinGecko as fallback
            console.warn('All exchange rate APIs failed, using CoinGecko fallback');
            return await fetchFiatRatesFromCoinGecko();
        }

        // Fill in missing fiat rates with approximate values (updated as of 2025)
        async function fillMissingFiatRates() {
            const approximateRates = {
                'INR': 85.0,    // Indian Rupee
                'CNY': 7.25,    // Chinese Yuan  
                'KRW': 1350,    // South Korean Won
                'BRL': 5.50,    // Brazilian Real
                'RUB': 95.0,    // Russian Ruble
                'MXN': 20.0,    // Mexican Peso
                'SGD': 1.35,    // Singapore Dollar
                'HKD': 7.80,    // Hong Kong Dollar
                'THB': 35.0,    // Thai Baht
                'MYR': 4.50,    // Malaysian Ringgit
                'IDR': 16000,   // Indonesian Rupiah
                'PHP': 55.0,    // Philippine Peso
                'VND': 24000,   // Vietnamese Dong
                'TRY': 30.0,    // Turkish Lira
                'ZAR': 18.0,    // South African Rand
                'AED': 3.67,    // UAE Dirham
                'SAR': 3.75,    // Saudi Riyal
                'PKR': 280,     // Pakistani Rupee
                'BDT': 120,     // Bangladeshi Taka
                'LKR': 300,     // Sri Lankan Rupee
                'NPR': 135,     // Nepalese Rupee
                'NOK': 11.0,    // Norwegian Krone
                'SEK': 10.5,    // Swedish Krona
                'DKK': 6.90,    // Danish Krone
                'PLN': 4.00,    // Polish Złoty
                'CZK': 23.0,    // Czech Koruna
                'HUF': 380,     // Hungarian Forint
                'BGN': 1.80,    // Bulgarian Lev
                'RON': 4.65,    // Romanian Leu
                'HRK': 6.95,    // Croatian Kuna
                'ILS': 3.70,    // Israeli Shekel
                'EGP': 50.0,    // Egyptian Pound
                'MAD': 10.0,    // Moroccan Dirham
                'NGN': 800,     // Nigerian Naira
                'GHS': 15.0,    // Ghanaian Cedi
                'KES': 130,     // Kenyan Shilling
                'UGX': 3800,    // Ugandan Shilling
                'TZS': 2500,    // Tanzanian Shilling
                'ZMW': 27.0,    // Zambian Kwacha
                'BWP': 13.5,    // Botswana Pula
                'NAD': 18.0,    // Namibian Dollar
                'SZL': 18.0,    // Swazi Lilangeni
                'LSL': 18.0,    // Lesotho Loti
                'MWK': 1700,    // Malawian Kwacha
                'RWF': 1300,    // Rwandan Franc
                'BIF': 2900,    // Burundian Franc
                'DJF': 178,     // Djiboutian Franc
                'ETB': 120,     // Ethiopian Birr
                'SOS': 570,     // Somali Shilling
            };

            let filledCount = 0;
            availableFiats.forEach(fiat => {
                if (fiat.id !== 'usd' && (!currencyData[fiat.id].price || currencyData[fiat.id].price === 1)) {
                    const rate = approximateRates[fiat.id.toUpperCase()];
                    if (rate) {
                        currencyData[fiat.id].price = rate;
                        filledCount++;
                    }
                }
            });

            if (filledCount > 0) {
                console.log(`✅ Filled ${filledCount} missing fiat rates with approximate values`);
            }
        }

        // Fallback fiat rate fetching using CoinGecko Bitcoin prices
        async function fetchFiatRatesFromCoinGecko() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd,eur,gbp,jpy,cad,aud,chf,cny,inr,krw,brl,rub,mxn,sgd,hkd,nok,sek,dkk,pln,czk&include_24hr_change=true');
                const data = await response.json();
                
                if (data.bitcoin) {
                    const btcPrices = data.bitcoin;
                    availableFiats.forEach(fiat => {
                        if (fiat.id === 'usd') {
                            currencyData[fiat.id].price = 1; // USD base
                        } else if (btcPrices[fiat.id]) {
                            // Correct exchange rate calculation: fiat_price / usd_price
                            currencyData[fiat.id].price = btcPrices[fiat.id] / btcPrices.usd;
                        }
                    });
                    
                    console.log('✅ Fiat rates updated using CoinGecko fallback');
                }
                
                return data;
            } catch (error) {
                console.error('CoinGecko fallback also failed:', error);
                return {};
            }
        }

        // Conversion history
        let conversionHistory = JSON.parse(localStorage.getItem('conversionHistory')) || [];

        // Convert between currencies
        function convert() {
            if (!selectedFromCurrency || !selectedToCurrency) return;
            
            const fromAmount = parseFloat(document.getElementById('fromAmount').value) || 0;

            if (fromAmount === 0) {
                document.getElementById('toAmount').value = '0';
                return;
            }

            let convertedAmount;

            if (selectedFromCurrency.type === 'crypto' && selectedToCurrency.type === 'fiat') {
                // Crypto to fiat - use direct rates from API
                const cryptoPrices = selectedFromCurrency.prices;
                const fiatSymbol = selectedToCurrency.id.toLowerCase();
                
                if (cryptoPrices && cryptoPrices[fiatSymbol]) {
                    // Direct conversion available
                    convertedAmount = fromAmount * cryptoPrices[fiatSymbol];
                } else {
                    // Fallback to USD conversion
                    const usdValue = fromAmount * selectedFromCurrency.price;
                    convertedAmount = usdValue / selectedToCurrency.price;
                }
            } else if (selectedFromCurrency.type === 'fiat' && selectedToCurrency.type === 'crypto') {
                // Fiat to crypto - use direct rates from API
                const cryptoPrices = selectedToCurrency.prices;
                const fiatSymbol = selectedFromCurrency.id.toLowerCase();
                
                if (cryptoPrices && cryptoPrices[fiatSymbol]) {
                    // Direct conversion available
                    convertedAmount = fromAmount / cryptoPrices[fiatSymbol];
                } else {
                    // Fallback to USD conversion
                    const usdValue = fromAmount * selectedFromCurrency.price;
                    convertedAmount = usdValue / selectedToCurrency.price;
                }
            } else if (selectedFromCurrency.type === 'crypto' && selectedToCurrency.type === 'crypto') {
                // Crypto to crypto - use USD as base
                const usdValue = fromAmount * selectedFromCurrency.price;
                convertedAmount = usdValue / selectedToCurrency.price;
            } else {
                // Fiat to fiat - convert through USD
                if (selectedFromCurrency.id === 'usd') {
                    // USD to other fiat
                    convertedAmount = fromAmount * selectedToCurrency.price;
                } else if (selectedToCurrency.id === 'usd') {
                    // Other fiat to USD
                    convertedAmount = fromAmount / selectedFromCurrency.price;
                } else {
                    // Other fiat to other fiat - convert through USD
                    const usdValue = fromAmount / selectedFromCurrency.price;
                    convertedAmount = usdValue * selectedToCurrency.price;
                }
            }

            // Display result
            document.getElementById('toAmount').value = convertedAmount.toLocaleString(undefined, {
                minimumFractionDigits: 2,
                maximumFractionDigits: 8
            });

            // Update exchange rate display
            const exchangeRate = convertedAmount / fromAmount;
            document.getElementById('exchangeRate').textContent = 
                `1 ${selectedFromCurrency.symbol} = ${exchangeRate.toLocaleString(undefined, {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 8
                })} ${selectedToCurrency.symbol}`;

            // Add to history
            addToHistory(fromAmount, selectedFromCurrency, convertedAmount, selectedToCurrency);
        }

        // Update price displays
        function updatePriceDisplay() {
            if (!selectedFromCurrency) return;

            if (selectedFromCurrency.type === 'crypto') {
                document.getElementById('fromPrice').textContent = `$${selectedFromCurrency.price?.toLocaleString() || '0'} per ${selectedFromCurrency.symbol}`;
            } else {
                document.getElementById('fromPrice').textContent = `1 ${selectedFromCurrency.symbol} = $${(1/selectedFromCurrency.price).toFixed(4)} USD`;
            }
        }

        // Swap currencies
        function swapCurrencies() {
            if (!selectedFromCurrency || !selectedToCurrency) return;
            
            const fromAmount = document.getElementById('fromAmount');
            const toAmount = document.getElementById('toAmount');

            // Add animation
            document.getElementById('swapButton').classList.add('flip-animation');
            setTimeout(() => {
                document.getElementById('swapButton').classList.remove('flip-animation');
            }, 600);

            // Swap currencies
            const tempCurrency = selectedFromCurrency;
            selectedFromCurrency = selectedToCurrency;
            selectedToCurrency = tempCurrency;

            const tempAmount = fromAmount.value;
            fromAmount.value = toAmount.value || tempAmount;

            // Update displays and convert
            updateCurrencyDisplay('from');
            updateCurrencyDisplay('to');
            updatePriceDisplay();
            convert();
        }

        // Load specific conversion
        function loadConversion(from, to, amount) {
            if (currencyData[from] && currencyData[to]) {
                selectedFromCurrency = currencyData[from];
                selectedToCurrency = currencyData[to];
                document.getElementById('fromAmount').value = amount;
                updateCurrencyDisplay('from');
                updateCurrencyDisplay('to');
                updatePriceDisplay();
                convert();
            }
        }

        // Add to conversion history
        function addToHistory(fromAmount, fromCurrency, toAmount, toCurrency) {
            const conversion = {
                from: `${fromAmount} ${fromCurrency.symbol}`,
                to: `${toAmount.toLocaleString(undefined, {maximumFractionDigits: 8})} ${toCurrency.symbol}`,
                timestamp: new Date().toLocaleTimeString()
            };

            conversionHistory.unshift(conversion);
            if (conversionHistory.length > 5) {
                conversionHistory = conversionHistory.slice(0, 5);
            }

            localStorage.setItem('conversionHistory', JSON.stringify(conversionHistory));
            updateHistoryDisplay();
        }

        // Update history display
        function updateHistoryDisplay() {
            const historyDiv = document.getElementById('conversionHistory');
            
            if (conversionHistory.length === 0) {
                historyDiv.innerHTML = '<p class="text-gray-400 text-center py-4">No conversions yet</p>';
                return;
            }

            historyDiv.innerHTML = conversionHistory.map(conv => `
                <div class="flex justify-between items-center bg-gray-700 rounded p-2 text-sm">
                    <span>${conv.from} → ${conv.to}</span>
                    <span class="text-gray-400">${conv.timestamp}</span>
                </div>
            `).join('');
        }

        // Clear history
        function clearHistory() {
            conversionHistory = [];
            localStorage.removeItem('conversionHistory');
            updateHistoryDisplay();
        }

        // Update market overview table with real-time data
        function updateMarketOverview() {
            // Update Bitcoin row
            document.querySelector('tr:nth-child(1) td:nth-child(2)').textContent = 
                `$${currencyData.bitcoin.price.toLocaleString()}`;
            
            // Update Ethereum row  
            document.querySelector('tr:nth-child(2) td:nth-child(2)').textContent = 
                `$${currencyData.ethereum.price.toLocaleString()}`;
                
            // Update Solana row
            document.querySelector('tr:nth-child(3) td:nth-child(2)').textContent = 
                `$${currencyData.solana.price.toLocaleString()}`;
                
            // Update popular conversion examples
            document.querySelector('.rate-card:nth-child(1) .text-green-400').textContent = 
                `$${currencyData.bitcoin.price.toLocaleString()}`;
            document.querySelector('.rate-card:nth-child(2) .text-green-400').textContent = 
                `$${currencyData.ethereum.price.toLocaleString()}`;
            document.querySelector('.rate-card:nth-child(3) .text-green-400').textContent = 
                `${(currencyData.bitcoin.price / currencyData.ethereum.price).toFixed(2)}`;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            // Load comprehensive currency lists first
            await loadCurrencyLists();
            
            // Set up event listeners
            document.getElementById('fromAmount').addEventListener('input', convert);

            // Fetch real-time rates on page load
            await fetchRealTimeRates();

            // Initial setup
            updatePriceDisplay();
            convert();
            updateHistoryDisplay();

            // Update rates every 2 minutes
            setInterval(fetchRealTimeRates, 2 * 60 * 1000);
        });
    </script>
</body>

</html>